<div class= 'box'>

<img src='{{usersProfile.user.image}}' />
  <p>Welcome, {{usersProfile.user.firstname}}! </p>
  <p>Your name: {{usersProfile.user.firstname}} {{usersProfile.user.surname}}</p>
  <p>Your email: {{usersProfile.user.email}}</p>
  <p>Your bio: {{usersProfile.user.bio}}</p>
  <hr />

  <p class="is-size-4">Your average rating as an asker:</p>
  <p class="is-size-4" ng-if='usersProfile.calculateAverageJobrating()'>{{ '⭐ '.repeat(usersProfile.calculateAverageJobrating()) }} ({{usersProfile.user.jobs.length}} ratings)</p>
  <p class="is-size-4" ng-if='!usersProfile.calculateAverageJobrating()'>Oh, you don't have a rating...yet</p>


  <p>You've asked for help with...</p>
  <div ng-repeat='job in usersProfile.user.jobs'>
    <p><a ui-sref='jobsShow({ id: job._id })'>{{job.category}}</a></p>
    <p>Job created {{job.createdAtRelative}}</p>
    <p>Number of applicants: {{job.applicants.length}}</p>
    <p>Status: {{job.status}}</p>
  </div>
  <hr/>

  <p class="is-size-4">Your average rating as a helper:</p>
  <p class="is-size-4" ng-if="usersProfile.user.avgRating">{{'⭐ '.repeat(usersProfile.user.avgRating)}} ({{usersProfile.user.userratings.length}} ratings)</p>
  <p class="is-size-4" ng-if="!usersProfile.user.avgRating">Oh, you don't have a rating...yet</p>

  <p>You are helping with:</p>
  <div ng-controller='JobsIndexCtrl as jobsIndex'>
  <div ng-repeat='job in jobsIndex.all' >
      <div ng-repeat='applicant in job.applicants'>
        <div ng-if="applicant.who === usersProfile.user._id">
        <div ng-if="applicant.status === 'accepted'">
          <p><a ui-sref='jobsShow({ id: job._id })'>{{job.category}} for {{job.createdBy.firstname}} {{job.createdBy.surname}}</a></p>
          <p>Job status: {{job.status}}</p>
          <p ng-if="job.status === 'reviewed'">How the asker rated you: {{ '⭐ '.repeat(job.jobrating) }}</p>
        </div>
        </div>
      </div>
  </div>
  </div>

<a ui-sref='usersEdit({ id: usersProfile.user._id })' class="button">Edit your account</a>
<button ng-click='usersProfile.handleDelete()' class='button is-danger'>Delete your account</button>

</div>
